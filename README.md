## KG-AMTL 项目结构说明

本项目用于实现 **Knowledge-Graph Augmented Adaptive Meta-Transfer Learning (KG-AMTL)** 在轴承故障诊断中的完整流程，对应文档 `SRP Guidance.pdf` 中的方法框架。

当前阶段以 **科研实验与算法实现** 为主，不依赖 Web/后端框架，采用“模块化库 + 脚本”的组织方式，方便后续扩展到生成增强、元学习和在线诊断等部分。

---

## 目录结构总览

- **`data/`**：数据集相关代码与说明  
- **`preprocess/`**：信号预处理与窗口切分  
- **`features/`**：多域物理特征提取  
- **`kg/`**：知识图谱构建与管理  
- **`models/`**：生成模型与元学习模型（为后续步骤预留）  
- **`configs/`**：实验与流水线配置  
- **`scripts/`**：可直接运行的实验脚本（命令行入口）  

下面对每个模块做简要说明，便于后续实现与维护。

---

## `data/`：数据加载与划分

- **定位**：与具体数据集强相关的逻辑全部集中在这里。
- **典型内容**：
  - CWRU、XJTU-SY 等轴承故障数据集的读取与格式统一；
  - 训练/验证/测试集划分；
  - 样本标签与工况（负载、转速等）元信息管理。
- **输出目标**：提供统一接口返回原始振动信号及对应标签，供 `preprocess/` 与 `features/` 使用。

---

## `preprocess/`：信号预处理与窗口切分

- **定位**：对原始振动信号做统一预处理，确保下游特征提取输入格式一致。
- **典型内容**：
  - 滑动窗口分割（例如文档中提到的 2400 点窗口，可以配置）；
  - 去均值、标准化、带通滤波等可选预处理步骤；
  - 不同通道（如驱动端/风扇端）的选择与组合策略。
- **输出目标**：将原始时间序列转化为片段矩阵，为 `features/` 提供批量信号切片。

---

## `features/`：多域物理特征提取

- **定位**：实现文档中 2.1 节和相关表格给出的时间域、频域、时频特征。
- **典型内容**：
  - `time_domain`：均值、方差、偏度、峰度、RMS、峰峰值、峭度因子等时间域特征集合；
  - `freq_domain`：FFT 及功率谱相关特征，如主频、频谱质心、带宽、带能量等；
  - `time_freq`：基于 VMD/小波/EMD 的模态能量 \(E_m\) 及其他时频特征；
  - `pipeline`：将多域特征拼接为统一特征向量 \(\mathbf{f}=[\mathcal{P}_{time},\mathcal{P}_{freq},\mathcal{P}_{t-f}]\) 的高层接口。
- **输出目标**：给出样本级特征矩阵和对应标签，为 `kg/` 的聚类和权重计算提供输入。

---

## `kg/`：知识图谱构建与管理

- **定位**：实现 2.1 Knowledge Graph Construction 与 6.1 Step 1 中的所有公式与结构定义。
- **典型内容**：
  - `clustering`：使用 Fuzzy C-Means 等方法计算隶属度 \(u_{ij}\) 与特征中心 \(v_{ik}\)；
  - `weighting`：根据文档中的公式计算 \(\sigma_{ik}\) 与特征-故障相关权重 \(w_{ik}\)，并做归一化与数值稳定处理；
  - `graph`：基于 `networkx` 等库构建知识图谱 \(\mathcal{KG}=(\mathcal{V}_f,\mathcal{V}_d,\mathcal{E},\mathcal{W})\)，管理特征节点、故障节点及其权重边，支持保存与加载；
  - （可选）简单可视化：如权重矩阵热力图、某故障对应的高相关特征子图等。
- **输出目标**：面向后续生成增强、元学习与在线诊断模块提供可查询、可更新的知识图谱。

---

## `models/`：生成模型与元学习模型（预留）

- **定位**：实现文档中 2.2 Physics-Constrained Generative Augmentation 与 2.3 Knowledge-Guided Meta-Transfer Learning 相关的深度学习模型与训练逻辑。
- **典型内容**（后续逐步补充）：
  - 物理约束条件生成器（GAN/条件生成网络），输入噪声及知识图谱属性，输出增强特征；
  - 元学习/Meta-Transfer Learning 主干网络、损失函数与内外循环更新；
  - 与 `kg/` 的接口：从知识图谱中读取 \(\mathbf{W}_i\)、特征中心等先验，用于初始化或动态加权。
- **输出目标**：形成独立可训练/可评估的模型模块，方便与 `scripts/` 中的实验脚本组合。

---

## `configs/`：实验配置与流水线参数

- **定位**：集中管理不同实验设置，做到“改配置不改代码”。
- **典型内容**：
  - 不同数据集的配置文件（如 CWRU、XJTU-SY），指定数据路径、采样频率、通道选择等；
  - 特征提取和预处理参数（窗口长度、步长、是否使用 VMD/小波等）；
  - 聚类与权重计算参数（类簇个数 C、模糊系数 m 等）；
  - 模型训练参数（学习率、迭代轮数、任务划分方式等）。
- **输出目标**：为 `scripts/` 和各模块提供统一的参数来源，方便复现实验和调参。

---

## `scripts/`：实验脚本与命令行入口

- **定位**：将各模块串成完整实验流程，便于一键运行和批量实验。
- **典型内容**：
  - `build_kg`：按照文档 2.1 和 6.1 的步骤，从数据 → 特征 → 聚类 → 权重 → 知识图谱的构建脚本；
  - `train_meta`：调用 `models/` 中的元学习/迁移学习模型，结合 `kg/` 的先验进行训练的脚本；
  - `run_diagnosis`：实现 3.1 Online Diagnosis Pipeline 的离线/半在线诊断流程；
  - 某些对比实验或 ablation study 的专用脚本。
- **输出目标**：提供统一的命令行接口，用配置文件驱动完整实验（如 `python scripts/build_kg.py --config configs/kg_cwru.yaml`）。

---

## 后续扩展建议

- 当需要将诊断功能部署为在线服务时，可以新增 `api/` 目录，使用 FastAPI/Flask 将 `scripts/run_diagnosis` 中的核心逻辑包装为 REST 接口；
- 可以在 `tests/` 目录中补充单元测试和简单集成测试，保证各模块在重构或扩展时行为稳定；
- 推荐在根目录维护一个 `requirements.txt` 或 `environment.yml`，记录项目依赖与版本，方便环境复现与共享。


